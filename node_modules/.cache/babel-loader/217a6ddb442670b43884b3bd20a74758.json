{"ast":null,"code":"var _jsxFileName = \"/Users/gohshengyang/Documents/GitHub/codagence-web/src/pages/login/Login.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState } from \"react\";\nimport { Layout, Row, Col, Form, Checkbox, Card } from \"antd\";\nimport \"./Login.less\";\nimport { useHistory } from \"react-router-dom\";\nimport { FirebaseServices } from \"../../utils/firebaseServices\";\nimport { AuthContext } from \"../../utils/AuthContext\";\nimport { BackHeader, EmailField, FormButton, PasswordField } from \"../../utils/components\";\nimport { UserRepo } from \"../../services/api/repositories/user_repo\";\nimport { RoutePath } from \"../../utils/routePath\";\nimport { Encryption } from \"../../utils/encryption\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst formItemLayout = {\n  labelCol: {\n    xs: {\n      span: 22\n    },\n    sm: {\n      span: 6\n    }\n  },\n  wrapperCol: {\n    xs: {\n      span: 22\n    },\n    sm: {\n      span: 14\n    }\n  }\n};\nconst tailFormItemLayout = {\n  wrapperCol: {\n    xs: {\n      span: 22,\n      offset: 0\n    },\n    sm: {\n      span: 14,\n      offset: 6\n    }\n  }\n};\nexport const Login = () => {\n  _s();\n\n  let userRepo = new UserRepo();\n  let history = useHistory(); // Get current sign in User\n\n  const user = useContext(AuthContext); // Is loading flag\n\n  const [isLoading, setLoading] = useState(false);\n\n  const onFinish = async values => {\n    setLoading(true);\n    console.log(\"Received values of form: \", values);\n    let firebaseResult = await FirebaseServices.logIn(values[\"email\"], values[\"password\"]);\n\n    if (firebaseResult.isSuccess) {\n      let apiResult = await userRepo.saveUser({\n        purpose: \"login\",\n        userId: firebaseResult.data.uid,\n        email: values[\"email\"],\n        password: Encryption.encrypt(values[\"password\"])\n      });\n\n      if (apiResult.isSuccess) {\n        var _firebaseResult$data;\n\n        // Check if the user has verify the email\n        if ((_firebaseResult$data = firebaseResult.data) === null || _firebaseResult$data === void 0 ? void 0 : _firebaseResult$data.emailVerified) {\n          // Go to home\n          alert(\"Log In success\");\n          history.replace(RoutePath.home);\n        } else {\n          // Go to email verification page\n          history.replace(RoutePath.email_verification);\n        }\n      } else {\n        alert(apiResult.message);\n      }\n    } else {\n      alert(firebaseResult.message);\n    }\n\n    setLoading(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    className: \"layout\",\n    style: {\n      overflow: \"auto\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"navbar\",\n      style: {\n        backgroundColor: \"#fff\"\n      },\n      children: /*#__PURE__*/_jsxDEV(BackHeader, {\n        title: \"Log In\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Layout, {\n      className: \"login_content\",\n      style: {\n        backgroundColor: \"white\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Row, {\n        className: \"login_form_row\",\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          xs: 24,\n          xl: 8,\n          className: \"login_form_col\",\n          span: 8\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          xs: 24,\n          xl: 8,\n          className: \"login_form_col\",\n          span: 8,\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            children: /*#__PURE__*/_jsxDEV(Form, {\n              name: \"normal_login\",\n              className: \"login_form\",\n              initialValues: {\n                remember: true\n              },\n              onFinish: onFinish,\n              ...formItemLayout,\n              children: [/*#__PURE__*/_jsxDEV(EmailField, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 104,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(PasswordField, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 105,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Form.Item, { ...tailFormItemLayout,\n                children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n                  name: \"remember\",\n                  valuePropName: \"checked\",\n                  noStyle: true,\n                  children: /*#__PURE__*/_jsxDEV(Checkbox, {\n                    children: \"Remember me\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 112,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 107,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: /*#__PURE__*/_jsxDEV(\"a\", {\n                    className: \"login_form_forgot_pwd\",\n                    href: RoutePath.forgot_password,\n                    children: \"Forgot password\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 115,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 114,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 106,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(Form.Item, { ...tailFormItemLayout,\n                children: [/*#__PURE__*/_jsxDEV(FormButton, {\n                  title: \"Log In\",\n                  isLoading: isLoading\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 125,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [\"Or\", \" \", /*#__PURE__*/_jsxDEV(\"a\", {\n                    onClick: () => {\n                      history.replace(RoutePath.register);\n                    },\n                    children: \"register now!\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 132,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 129,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 124,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          xs: 24,\n          xl: 8,\n          className: \"login_form_col\",\n          span: 8\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Login, \"EyPKeMDobSJo4EWwLcvmO8DrOEQ=\", false, function () {\n  return [useHistory];\n});\n\n_c = Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/Users/gohshengyang/Documents/GitHub/codagence-web/src/pages/login/Login.tsx"],"names":["React","useContext","useState","Layout","Row","Col","Form","Checkbox","Card","useHistory","FirebaseServices","AuthContext","BackHeader","EmailField","FormButton","PasswordField","UserRepo","RoutePath","Encryption","formItemLayout","labelCol","xs","span","sm","wrapperCol","tailFormItemLayout","offset","Login","userRepo","history","user","isLoading","setLoading","onFinish","values","console","log","firebaseResult","logIn","isSuccess","apiResult","saveUser","purpose","userId","data","uid","email","password","encrypt","emailVerified","alert","replace","home","email_verification","message","overflow","backgroundColor","remember","forgot_password","register"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from \"react\";\nimport _ from \"lodash\";\nimport { Layout, Row, Col, Form, Checkbox, Card } from \"antd\";\nimport \"./Login.less\";\nimport { useHistory } from \"react-router-dom\";\nimport { FirebaseServices } from \"../../utils/firebaseServices\";\nimport { AuthContext } from \"../../utils/AuthContext\";\nimport {\n    BackHeader,\n    EmailField,\n    FormButton,\n    PasswordField,\n} from \"../../utils/components\";\nimport { UserRepo } from \"../../services/api/repositories/user_repo\";\nimport { RoutePath } from \"../../utils/routePath\";\nimport { Encryption } from \"../../utils/encryption\";\n\nconst formItemLayout = {\n    labelCol: {\n        xs: { span: 22 },\n        sm: { span: 6 },\n    },\n    wrapperCol: {\n        xs: { span: 22 },\n        sm: { span: 14 },\n    },\n};\n\nconst tailFormItemLayout = {\n    wrapperCol: {\n        xs: {\n            span: 22,\n            offset: 0,\n        },\n        sm: {\n            span: 14,\n            offset: 6,\n        },\n    },\n};\n\nexport const Login: React.FC<any> = () => {\n    let userRepo = new UserRepo();\n\n    let history = useHistory();\n\n    // Get current sign in User\n    const user = useContext(AuthContext);\n\n    // Is loading flag\n    const [isLoading, setLoading] = useState(false);\n\n    const onFinish = async (values: any) => {\n        setLoading(true);\n        console.log(\"Received values of form: \", values);\n        let firebaseResult = await FirebaseServices.logIn(\n            values[\"email\"],\n            values[\"password\"]\n        );\n        if (firebaseResult.isSuccess) {\n            let apiResult = await userRepo.saveUser({\n                purpose: \"login\",\n                userId: firebaseResult.data.uid,\n                email: values[\"email\"],\n                password: Encryption.encrypt(values[\"password\"]),\n            });\n\n            if (apiResult.isSuccess) {\n                // Check if the user has verify the email\n                if (firebaseResult.data?.emailVerified) {\n                    // Go to home\n                    alert(\"Log In success\");\n                    history.replace(RoutePath.home);\n                } else {\n                    // Go to email verification page\n                    history.replace(RoutePath.email_verification);\n                }\n            } else {\n                alert(apiResult.message);\n            }\n        } else {\n            alert(firebaseResult.message);\n        }\n        setLoading(false);\n    };\n\n    return (\n        <Layout className=\"layout\" style={{ overflow: \"auto\" }}>\n            <div className=\"navbar\" style={{ backgroundColor: \"#fff\" }}>\n                <BackHeader title=\"Log In\" />\n            </div>\n            <Layout className=\"login_content\" style={{ backgroundColor: \"white\" }}>\n                <Row className=\"login_form_row\">\n                    <Col xs={24} xl={8} className=\"login_form_col\" span={8} />\n                    <Col xs={24} xl={8} className=\"login_form_col\" span={8}>\n                        <Card>\n                            <Form\n                                name=\"normal_login\"\n                                className=\"login_form\"\n                                initialValues={{ remember: true }}\n                                onFinish={onFinish}\n                                {...formItemLayout}\n                            >\n                                <EmailField />\n                                <PasswordField />\n                                <Form.Item {...tailFormItemLayout}>\n                                    <Form.Item\n                                        name=\"remember\"\n                                        valuePropName=\"checked\"\n                                        noStyle\n                                    >\n                                        <Checkbox>Remember me</Checkbox>\n                                    </Form.Item>\n                                    <div>\n                                        <a\n                                            className=\"login_form_forgot_pwd\"\n                                            href={RoutePath.forgot_password}\n                                        >\n                                            Forgot password\n                                        </a>\n                                    </div>\n                                </Form.Item>\n\n                                <Form.Item {...tailFormItemLayout}>\n                                    <FormButton\n                                        title=\"Log In\"\n                                        isLoading={isLoading}\n                                    />\n                                    <div>\n                                        Or{\" \"}\n                                        {/* The href is not inserted in the <a> tag to allow the replacingg of log in page when the user click on the link*/}\n                                        <a\n                                            onClick={() => {\n                                                history.replace(\n                                                    RoutePath.register\n                                                );\n                                            }}\n                                        >\n                                            register now!\n                                        </a>\n                                    </div>\n                                </Form.Item>\n                            </Form>\n                        </Card>\n                    </Col>\n                    <Col xs={24} xl={8} className=\"login_form_col\" span={8} />\n                </Row>\n            </Layout>\n        </Layout>\n    );\n};\n"]},"metadata":{},"sourceType":"module"}